# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ Ð¼Ð°ÑˆÐ¸Ð½Ð°Ð¼Ð¸ Proxmox

Ð£Ð½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ð¹ bash-ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹ ÑÐ¾ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð°Ð¼Ð¸, Ð±ÑÐºÐ°Ð¿Ð°Ð¼Ð¸ Ð¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ Ð¼Ð°ÑˆÐ¸Ð½Ð°Ð¼Ð¸ Ð² Proxmox VE.

## Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸

- âœ… Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð¾Ð² Ð´Ð»Ñ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ð° Ð’Ðœ
- â®ï¸ ÐžÑ‚ÐºÐ°Ñ‚ Ð’Ðœ Ðº ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ñƒ
- ðŸ—‘ï¸ Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð¾Ð²
- ðŸ’¾ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð±ÑÐºÐ°Ð¿Ð¾Ð²
- ðŸ”„ Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð· Ð±ÑÐºÐ°Ð¿Ð¾Ð²
- ðŸ“‹ ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ ÑÐ¿Ð¸ÑÐºÐ° Ð’Ðœ Ð¸ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð¾Ð²
- ðŸ“¦ ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… Ð±ÑÐºÐ°Ð¿Ð¾Ð²
- ðŸ’¥ ÐœÐ°ÑÑÐ¾Ð²Ð¾Ðµ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð’Ðœ

## Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ

```bash
./prox.sh ACTION START END [DESCRIPTION] [STORAGE] [BACKUP_ID]
```

### ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹

| ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ | ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|----------|--------------|----------|
| `ACTION` | âœ… Ð”Ð° | Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ð´Ð»Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ |
| `START` | âœ… Ð”Ð° | ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ñ‹Ð¹ ID Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð¼Ð°ÑˆÐ¸Ð½Ñ‹ |
| `END` | âœ… Ð”Ð° | ÐšÐ¾Ð½ÐµÑ‡Ð½Ñ‹Ð¹ ID Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð¼Ð°ÑˆÐ¸Ð½Ñ‹ |
| `DESCRIPTION` | âš ï¸ Ð—Ð°Ð²Ð¸ÑÐ¸Ñ‚ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð°/Ð±ÑÐºÐ°Ð¿Ð° |
| `STORAGE` | âš ï¸ Ð—Ð°Ð²Ð¸ÑÐ¸Ñ‚ | Ð˜Ð¼Ñ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ð° |
| `BACKUP_ID` | âŒ ÐÐµÑ‚ | ID ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð³Ð¾ Ð±ÑÐºÐ°Ð¿Ð° |

## Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ

### 1. create - Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð¾Ð²

Ð¡Ð¾Ð·Ð´Ð°ÐµÑ‚ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚ Ð´Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð’Ðœ Ð² ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ð¾Ð¼ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ðµ.

**Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ:**
```bash
./prox.sh create START END "DESCRIPTION"
```

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**
```bash
./prox.sh create 200 232 "before_update"
```

**ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸:**
- ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÑ‚ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ Ð¸Ð¼Ñ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð° Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ Ð¼ÐµÑ‚ÐºÐ¾Ð¹
- Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ Ð¸Ð¼ÐµÐ½Ð¸: `snap-YYYYMMDD-HHMMSS`
- ÐŸÑ€Ð¾Ð¿ÑƒÑÐºÐ°ÐµÑ‚ Ð½ÐµÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ Ð’Ðœ

---

### 2. rollback - ÐžÑ‚ÐºÐ°Ñ‚ Ðº ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ñƒ

ÐžÑ‚ÐºÐ°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ð’Ðœ Ðº Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ¼Ñƒ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ñƒ Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ð¼ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸ÐµÐ¼.

**Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ:**
```bash
./prox.sh rollback START END "DESCRIPTION"
```

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**
```bash
./prox.sh rollback 200 210 "before_update"
```

**ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸:**
- ÐÐ°Ñ…Ð¾Ð´Ð¸Ñ‚ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚ Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ð¼ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸ÐµÐ¼
- ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ Ð’Ðœ Ð¿Ð¾ÑÐ»Ðµ Ð¾Ñ‚ÐºÐ°Ñ‚Ð°
- Ð•ÑÐ»Ð¸ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½, Ð’Ðœ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ

---

### 3. delete - Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð¾Ð²

Ð£Ð´Ð°Ð»ÑÐµÑ‚ Ð²ÑÐµ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ñ‹ Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ð¼ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸ÐµÐ¼.

**Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ:**
```bash
./prox.sh delete START END "DESCRIPTION"
```

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**
```bash
./prox.sh delete 200 232 "old_snapshot"
```

**ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸:**
- Ð£Ð´Ð°Ð»ÑÐµÑ‚ Ð’Ð¡Ð• ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ñ‹, ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‰Ð¸Ðµ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ð¾Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ
- Ð’Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð½Ð°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ñ… ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð¾Ð² Ð¿ÐµÑ€ÐµÐ´ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸ÐµÐ¼

---

### 4. backup - Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð±ÑÐºÐ°Ð¿Ð°

Ð¡Ð¾Ð·Ð´Ð°ÐµÑ‚ Ð±ÑÐºÐ°Ð¿ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð¼Ð°ÑˆÐ¸Ð½Ñ‹ Ð² ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ð¾Ðµ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ.

**Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ:**
```bash
./prox.sh backup START END "DESCRIPTION" STORAGE
```

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**
```bash
./prox.sh backup 200 205 "weekly_backup" local-zfs
```

**ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð±ÑÐºÐ°Ð¿Ð°:**
- Ð ÐµÐ¶Ð¸Ð¼: `snapshot` (ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð° Ð´Ð»Ñ ÐºÐ¾Ð½ÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð½Ð¾ÑÑ‚Ð¸)
- Ð¡Ð¶Ð°Ñ‚Ð¸Ðµ: `zstd` (Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ðµ Ð¸ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾Ðµ ÑÐ¶Ð°Ñ‚Ð¸Ðµ)
- Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚Ð°Ñ€Ñ‹Ñ… Ð±ÑÐºÐ°Ð¿Ð¾Ð²: Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾ (`--remove 0`)
- ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ÑÑ Ð² Ð¼ÐµÑ‚Ð°Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð±ÑÐºÐ°Ð¿Ð°

---

### 5. restore - Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð· Ð±ÑÐºÐ°Ð¿Ð°

Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ Ð’Ðœ Ð¸Ð· Ð±ÑÐºÐ°Ð¿Ð°. ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ ÐºÐ°Ðº Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð²Ñ‹Ð±Ð¾Ñ€ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð±ÑÐºÐ°Ð¿Ð°, Ñ‚Ð°Ðº Ð¸ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð· ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð³Ð¾ Ñ„Ð°Ð¹Ð»Ð°.

**Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ:**
```bash
# ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð· Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð±ÑÐºÐ°Ð¿Ð°
./prox.sh restore START END "auto" STORAGE

# Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð· ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð³Ð¾ Ð±ÑÐºÐ°Ð¿Ð°
./prox.sh restore START END "" STORAGE "BACKUP_FILENAME"
```

**ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹:**
```bash
# Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ Ð±ÑÐºÐ°Ð¿ Ð’Ðœ 200
./prox.sh restore 200 200 "auto" local-zfs

# Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¸Ð· ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð³Ð¾ Ñ„Ð°Ð¹Ð»Ð°
./prox.sh restore 200 200 "" local-zfs "vzdump-qemu-200-2024_01_15-12_30_45.vma.zst"
```

**ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸:**
- Ð•ÑÐ»Ð¸ VMID Ð½Ðµ ÑƒÐºÐ°Ð·Ð°Ð½ Ð¸Ð»Ð¸ Ñ€Ð°Ð²ÐµÐ½ `"auto"`, Ð²Ñ‹Ð±Ð¸Ñ€Ð°ÐµÑ‚ÑÑ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ Ð±ÑÐºÐ°Ð¿
- Ð¦ÐµÐ»ÐµÐ²Ð¾Ðµ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ: `local` (Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð² Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ `get_target_storage`)
- ÐŸÑ€Ð¸ Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ð¸ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ¹ Ð’Ðœ Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ Ð½Ð° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ
- ÐžÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ Ð’Ðœ Ð¿ÐµÑ€ÐµÐ´ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸ÐµÐ¼
- ÐŸÐ¾ÑÐ»Ðµ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ñ€ÐµÐ´Ð»Ð°Ð³Ð°ÐµÑ‚ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð’Ðœ
- ÐœÐ¾Ð¶Ð½Ð¾ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð±ÑÐºÐ°Ð¿ Ñ Ð´Ñ€ÑƒÐ³Ð¸Ð¼ VMID

**ÐŸÑ€Ð¾Ñ†ÐµÑÑ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ:**
1. ÐŸÐ¾Ð¸ÑÐº Ð±ÑÐºÐ°Ð¿Ð° (Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¸Ð»Ð¸ Ð¿Ð¾ Ð¸Ð¼ÐµÐ½Ð¸ Ñ„Ð°Ð¹Ð»Ð°)
2. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ†ÐµÐ»ÐµÐ²Ð¾Ð³Ð¾ VMID
3. ÐŸÐ¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ (ÐµÑÐ»Ð¸ Ð’Ðœ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚)
4. ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð¸ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ¹ Ð’Ðœ
5. Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð· Ð±ÑÐºÐ°Ð¿Ð°
6. ÐžÐ¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾: Ð·Ð°Ð¿ÑƒÑÐº Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ð¾Ð¹ Ð’Ðœ

---

### 6. listbackup - ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð±ÑÐºÐ°Ð¿Ð¾Ð²

ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð²ÑÐµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ Ð±ÑÐºÐ°Ð¿Ñ‹ Ð´Ð»Ñ Ð’Ðœ Ð² ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ð¾Ð¼ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ.

**Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ:**
```bash
./prox.sh listbackup START END STORAGE
```

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**
```bash
./prox.sh listbackup 200 210 local-zfs
```

**Ð’Ñ‹Ð²Ð¾Ð´ Ð²ÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚:**
- Ð˜Ð¼Ñ Ñ„Ð°Ð¹Ð»Ð° Ð±ÑÐºÐ°Ð¿Ð°
- Ð Ð°Ð·Ð¼ÐµÑ€ Ð±ÑÐºÐ°Ð¿Ð°
- VMID Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð¼Ð°ÑˆÐ¸Ð½Ñ‹
- Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð¾Ñ‚ÑÐ¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½ Ð¾Ñ‚ Ð½Ð¾Ð²Ñ‹Ñ… Ðº ÑÑ‚Ð°Ñ€Ñ‹Ð¼

---

### 7. list - ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð’Ðœ Ð¸ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð¾Ð²

Ð’Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð¼Ð°ÑˆÐ¸Ð½Ð°Ñ… Ð¸ Ð¸Ñ… ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð°Ñ….

**Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ:**
```bash
./prox.sh list START END
```

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**
```bash
./prox.sh list 200 210
```

**ÐžÑ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÐµÐ¼Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ:**
- ID Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð¼Ð°ÑˆÐ¸Ð½Ñ‹
- Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ ÑÑ‚Ð°Ñ‚ÑƒÑ (running/stopped)
- Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð²ÑÐµÑ… ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð¾Ð² Ñ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸ÑÐ¼Ð¸

---

### 8. Destroy - Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð’Ðœ

Ð£Ð´Ð°Ð»ÑÐµÑ‚ Ð²ÑÐµ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¼Ð°ÑˆÐ¸Ð½Ñ‹ Ð² ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ð¾Ð¼ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ðµ. **Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ñ!**

**Ð¡Ð¸Ð½Ñ‚Ð°ÐºÑÐ¸Ñ:**
```bash
./prox.sh Destroy START END
```

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**
```bash
./prox.sh Destroy 200 232
```

**âš ï¸ Ð’ÐÐ˜ÐœÐÐÐ˜Ð•:**
- Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ð½ÐµÐ¾Ð±Ñ€Ð°Ñ‚Ð¸Ð¼Ð¾!
- ÐŸÐµÑ€ÐµÐ´ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸ÐµÐ¼ Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ `yes`
- Ð£Ð´Ð°Ð»ÑÐµÑ‚ Ð’Ðœ Ð²Ð¼ÐµÑÑ‚Ðµ ÑÐ¾ Ð²ÑÐµÐ¼Ð¸ Ð´Ð¸ÑÐºÐ°Ð¼Ð¸ Ð¸ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÐµÐ¹

---

## Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ð°Ð¼Ð¸

Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ ÐºÐ°Ðº Ð¿Ñ€ÑÐ¼Ñ‹Ðµ, Ñ‚Ð°Ðº Ð¸ Ð¾Ð±Ñ€Ð°Ñ‚Ð½Ñ‹Ðµ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ñ‹:

```bash
# ÐŸÑ€ÑÐ¼Ð¾Ð¹ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½: 200, 201, 202, ..., 210
./prox.sh list 200 210

# ÐžÐ±Ñ€Ð°Ñ‚Ð½Ñ‹Ð¹ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½: 210, 209, 208, ..., 200
./prox.sh list 210 200
```

## ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¾ÑˆÐ¸Ð±Ð¾Ðº

Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸Ð¸:

- âœ… ÐŸÑ€Ð¾Ð¿ÑƒÑÐº Ð½ÐµÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… Ð’Ðœ
- âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ð½Ð¸Ñ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð¾Ð² Ð¿ÐµÑ€ÐµÐ´ Ð¾Ñ‚ÐºÐ°Ñ‚Ð¾Ð¼
- âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ð½Ð¸Ñ Ð±ÑÐºÐ°Ð¿Ð¾Ð² Ð¿ÐµÑ€ÐµÐ´ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸ÐµÐ¼
- âœ… Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð²
- âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð° ID Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð¼Ð°ÑˆÐ¸Ð½

## Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ

ÐŸÐ¾ÑÐ»Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ Ð´ÐµÑ‚Ð°Ð»ÑŒÐ½ÑƒÑŽ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÑƒ:

```
=========================================
ðŸ“Š Ð¡Ð¢ÐÐ¢Ð˜Ð¡Ð¢Ð˜ÐšÐ Ð’Ð«ÐŸÐžÐ›ÐÐ•ÐÐ˜Ð¯
=========================================
âœ… Ð£ÑÐ¿ÐµÑˆÐ½Ð¾: 10
âš ï¸  ÐŸÑ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð¾: 2
âŒ ÐžÑˆÐ¸Ð±Ð¾Ðº: 0
ðŸ“ Ð’ÑÐµÐ³Ð¾ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð¾: 12 Ð¸Ð· 12
=========================================
```

**Ð¡Ñ‡ÐµÑ‚Ñ‡Ð¸ÐºÐ¸:**
- **Ð£ÑÐ¿ÐµÑˆÐ½Ð¾** - Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ñ‹ Ð±ÐµÐ· Ð¾ÑˆÐ¸Ð±Ð¾Ðº
- **ÐŸÑ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð¾** - Ð’Ðœ Ð½Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚ Ð¸Ð»Ð¸ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ñ Ð½Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ð¸Ð¼Ð°
- **ÐžÑˆÐ¸Ð±Ð¾Ðº** - Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð·Ð°Ð²ÐµÑ€ÑˆÐ¸Ð»Ð¸ÑÑŒ Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ¾Ð¹

## Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ðµ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ

- Proxmox VE 6.x Ð¸Ð»Ð¸ Ð²Ñ‹ÑˆÐµ
- Bash 4.0+
- ÐŸÑ€Ð°Ð²Ð° root Ð¸Ð»Ð¸ sudo Ð´Ð»Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´ `qm`, `vzdump`, `pvesm`

## Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Proxmox

| ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° | ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ |
|---------|------------|
| `qm status` | ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ð’Ðœ |
| `qm snapshot` | Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð° |
| `qm listsnapshot` | Ð¡Ð¿Ð¸ÑÐ¾Ðº ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð¾Ð² Ð’Ðœ |
| `qm rollback` | ÐžÑ‚ÐºÐ°Ñ‚ Ðº ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ñƒ |
| `qm delsnapshot` | Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð° |
| `qm start` | Ð—Ð°Ð¿ÑƒÑÐº Ð’Ðœ |
| `qm stop` | ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð’Ðœ |
| `qm destroy` | Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð’Ðœ |
| `qmrestore` | Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð· Ð±ÑÐºÐ°Ð¿Ð° |
| `vzdump` | Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð±ÑÐºÐ°Ð¿Ð° |
| `pvesm list` | Ð¡Ð¿Ð¸ÑÐ¾Ðº Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð² Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ |

## ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ

### Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ workflow Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸ÐµÐ¼

```bash
# 1. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ñ‹ Ð¿ÐµÑ€ÐµÐ´ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸ÐµÐ¼
./prox.sh create 200 210 "before_kernel_update"

# 2. Ð’Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð½Ð° Ð’Ðœ (Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ)
# ...

# 3. Ð•ÑÐ»Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾ÑˆÐ»Ð¾ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ - ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ñ‹
./prox.sh delete 200 210 "before_kernel_update"

# 4. Ð•ÑÐ»Ð¸ Ð½ÑƒÐ¶ÐµÐ½ Ð¾Ñ‚ÐºÐ°Ñ‚ - Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ðº ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ñƒ
./prox.sh rollback 200 210 "before_kernel_update"
```

### Ð ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ð¾Ðµ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

```bash
# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ ÐµÐ¶ÐµÐ½ÐµÐ´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð±ÑÐºÐ°Ð¿ Ð²ÑÐµÑ… production Ð’Ðœ
./prox.sh backup 300 350 "weekly_$(date +%Y%m%d)" local-zfs

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÑÐ¾Ð·Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð±ÑÐºÐ°Ð¿Ñ‹
./prox.sh listbackup 300 350 local-zfs
```

### ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ñ Ð’Ðœ Ñ‡ÐµÑ€ÐµÐ· Ð±ÑÐºÐ°Ð¿

```bash
# 1. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð±ÑÐºÐ°Ð¿ Ð’Ðœ 200
./prox.sh backup 200 200 "migration" local-zfs

# 2. Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð’Ðœ Ñ Ð½Ð¾Ð²Ñ‹Ð¼ ID 250
./prox.sh restore 250 250 "" local-zfs "vzdump-qemu-200-2024_01_15.vma.zst"
```

### ÐœÐ°ÑÑÐ¾Ð²Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸

```bash
# ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ð²ÑÐµÑ… Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ñ… Ð’Ðœ
./prox.sh list 100 150

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð¾Ð² Ð´Ð»Ñ Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹ Ð’Ðœ
./prox.sh create 100 150 "test_snapshot"

# Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ñ… Ð’Ðœ
./prox.sh Destroy 100 150
```

## Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ

### Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸

1. **Ð’ÑÐµÐ³Ð´Ð° ÑÐ¾Ð·Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð±ÑÐºÐ°Ð¿Ñ‹** Ð¿ÐµÑ€ÐµÐ´ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼Ð¸ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸ÑÐ¼Ð¸
2. **Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð¾Ð¿Ð¸ÑÐ°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¸Ð¼ÐµÐ½Ð°** Ð´Ð»Ñ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð¾Ð² Ð¸ Ð±ÑÐºÐ°Ð¿Ð¾Ð²
3. **ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐ¹Ñ‚Ðµ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½** Ð¿ÐµÑ€ÐµÐ´ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸ÐµÐ¼ Ð¼Ð°ÑÑÐ¾Ð²Ñ‹Ñ… Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹
4. **Ð¥Ñ€Ð°Ð½Ð¸Ñ‚Ðµ Ð±ÑÐºÐ°Ð¿Ñ‹** Ð½Ð° Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð¾Ð¼ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ
5. **Ð ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ð¾ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐ¹Ñ‚Ðµ** Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð¸Ð· Ð±ÑÐºÐ°Ð¿Ð¾Ð²

### ÐžÐ¿Ð°ÑÐ½Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸

âš ï¸ **Destroy** - ÑƒÐ´Ð°Ð»ÑÐµÑ‚ Ð’Ðœ Ð±ÐµÐ·Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð½Ð¾  
âš ï¸ **restore** - Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÑ‚ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÑƒÑŽ Ð’Ðœ  
âš ï¸ **rollback** - Ð¾Ñ‚ÐºÐ°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð¿Ð¾ÑÐ»Ðµ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð°

## ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°

### Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ»ÐµÐ²Ð¾Ð³Ð¾ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ð°

ÐŸÐ¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ Ð¿Ñ€Ð¸ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ `local`. Ð§Ñ‚Ð¾Ð±Ñ‹ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ, Ð¾Ñ‚Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ `get_target_storage`:

```bash
get_target_storage() {
    # Ð˜Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð½Ð° Ð½ÑƒÐ¶Ð½Ð¾Ðµ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ
    local default_storage="local-ssd-seagate2tb"
    
    # Ð˜Ð»Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð»Ð¾Ð³Ð¸ÐºÑƒ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð¿Ð¾ VMID
    # if [ $1 -ge 200 ] && [ $1 -le 299 ]; then
    #     echo "local-ssd"
    # else
    #     echo "local-zfs"
    # fi
    
    echo "$default_storage"
    return 0
}
```

## Ð£ÑÑ‚Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð½ÐµÐ¿Ð¾Ð»Ð°Ð´Ð¾Ðº

### Ð’Ðœ Ð½Ðµ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑÑ

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÑÐ¿Ð¸ÑÐ¾Ðº Ð²ÑÐµÑ… Ð’Ðœ
qm list

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½ÑƒÑŽ Ð’Ðœ
qm status 200
```

### Ð‘ÑÐºÐ°Ð¿ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ð°
pvesm list local-zfs

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð±ÑÐºÐ°Ð¿Ñ‹ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð¹ Ð’Ðœ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ
ls /mnt/pve/local-zfs/dump/ | grep "vzdump-qemu-200"
```

### ÐÐµÐ´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð¿Ñ€Ð°Ð²

```bash
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð¾Ñ‚ root
sudo ./prox.sh list 200 210

# Ð˜Ð»Ð¸ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð² Ð³Ñ€ÑƒÐ¿Ð¿Ñƒ
usermod -aG sudo username
```

## Ð›Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½ÑƒÑŽ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸:

- ðŸ“¸ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ð°
- â®ï¸ ÐžÑ‚ÐºÐ°Ñ‚ Ðº ÑÐ½Ð°Ð¿ÑˆÐ¾Ñ‚Ñƒ
- ðŸ—‘ï¸ Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ
- ðŸ’¾ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð±ÑÐºÐ°Ð¿Ð°
- ðŸ”„ Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ
- âœ… Ð£ÑÐ¿ÐµÑ…
- âš ï¸ ÐŸÑ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ðµ
- âŒ ÐžÑˆÐ¸Ð±ÐºÐ°

Ð”Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð»Ð¾Ð³Ð° Ð² Ñ„Ð°Ð¹Ð»:

```bash
./prox.sh create 200 210 "snapshot" 2>&1 | tee operation.log
```
